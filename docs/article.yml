- name: campaign
  doc:
    title: キャンペーン
    context:
      - 記事に紐づけられるイベント
      - キャンペーンは運営のみ作成できる
  fields:
    - name: id
      type: AutoField
      verbose_name: id
      is_null: false
      is_allow_blank: true
      is_unique: true
      primary_key: true
      index: false
    - name: updated_at
      type: DateTimeField
      verbose_name: 更新日時
      is_null: false
      is_allow_blank: true
      is_unique: false
      primary_key: false
      index: false
    - name: name
      type: CharField
      verbose_name: イベント名
      is_null: false
      is_allow_blank: false
      is_unique: false
      primary_key: false
      index: false
    - name: type
      type: CharField
      choices:
        - value: OFFCIAL
          label: 公式
        - value: CLIENT
          label: 企業
        - value: GROUP
          label: グループ
      verbose_name: キャンペーンタイプ
      is_null: false
      is_allow_blank: false
      is_unique: false
      primary_key: false
      index: false
    - name: group
      type: ForeignKey
      verbose_name: 対象グループ
      is_null: true
      is_allow_blank: false
      is_unique: false
      primary_key: false
      relation: Group
      index: true
    - name: description
      type: CharField
      verbose_name: イベント概要
      is_null: false
      is_allow_blank: true
      is_unique: false
      primary_key: false
      index: false
    - name: start_at
      type: DateTimeField
      verbose_name: イベント開始日時
      is_null: false
      is_allow_blank: false
      is_unique: false
      primary_key: false
      index: false
    - name: end_at
      type: DateTimeField
      verbose_name: イベント終了日時
      is_null: false
      is_allow_blank: false
      is_unique: false
      primary_key: false
      index: false
  constraints:
    - type: CheckConstraint
      fields: []
      name: campaign_period_valid
      condition: '(AND: (''end_at__gte'', F(start_at)))'
    - type: CheckConstraint
      fields: []
      name: campaign_type_group_valid
      condition: '(OR: (AND: (''group__isnull'', True), (''type'', ''OFFCIAL'')),
        (AND: (''group__isnull'', False), (''type__in'', (''CLIENT'', ''GROUP''))))'
  index: []
- name: article
  doc:
    title: 記事
  fields:
    - name: id
      type: AutoField
      verbose_name: id
      is_null: false
      is_allow_blank: true
      is_unique: true
      primary_key: true
      index: false
    - name: created_at
      type: DateTimeField
      verbose_name: created at
      is_null: false
      is_allow_blank: true
      is_unique: false
      primary_key: false
      index: false
    - name: updated_at
      type: DateTimeField
      verbose_name: updated at
      is_null: false
      is_allow_blank: true
      is_unique: false
      primary_key: false
      index: false
    - name: title
      type: CharField
      verbose_name: 記事タイトル
      is_null: false
      is_allow_blank: false
      is_unique: false
      primary_key: false
      index: false
    - name: article_path
      type: TextField
      verbose_name: 記事実態の保存先パス
      help_text: 記事の内容と記事内のメディアはそこに保存される
      is_null: false
      is_allow_blank: false
      is_unique: false
      primary_key: false
      index: false
    - name: user
      type: ForeignKey
      verbose_name: 記事の作成者
      is_null: false
      is_allow_blank: false
      is_unique: false
      primary_key: false
      relation: User
      index: true
  constraints:
    - type: UniqueConstraint
      fields:
        - user
        - title
      name: article_title_and_user_uniq
  index: []
- name: article_tag_relation
  doc:
    title: 記事へのタグ付け
    context:
      - ユーザーが記事にタグ付けできる
      - タグを外せばレコードが削除される
  fields:
    - name: id
      type: AutoField
      verbose_name: id
      is_null: false
      is_allow_blank: true
      is_unique: true
      primary_key: true
      index: false
    - name: created_at
      type: DateTimeField
      verbose_name: created at
      is_null: false
      is_allow_blank: true
      is_unique: false
      primary_key: false
      index: false
    - name: created_by
      type: ForeignKey
      verbose_name: タグの付与者
      is_null: false
      is_allow_blank: false
      is_unique: false
      primary_key: false
      relation: User
      index: true
    - name: article
      type: ForeignKey
      verbose_name: article
      is_null: false
      is_allow_blank: false
      is_unique: false
      primary_key: false
      relation: Article
      index: true
    - name: tag
      type: ForeignKey
      verbose_name: tag
      is_null: false
      is_allow_blank: false
      is_unique: false
      primary_key: false
      relation: Tag
      index: true
  constraints:
    - type: UniqueConstraint
      fields:
        - article
        - tag
      name: article_and_tag_uniq
  index: []
- name: article_campaign_relation
  doc:
    title: 記事とキャンペーンの紐付け
  fields:
    - name: id
      type: AutoField
      verbose_name: id
      is_null: false
      is_allow_blank: true
      is_unique: true
      primary_key: true
      index: false
    - name: article
      type: ForeignKey
      verbose_name: article
      is_null: false
      is_allow_blank: false
      is_unique: false
      primary_key: false
      relation: Article
      index: true
    - name: campaign
      type: ForeignKey
      verbose_name: campaign
      is_null: false
      is_allow_blank: false
      is_unique: false
      primary_key: false
      relation: Campaign
      index: true
  constraints:
    - type: UniqueConstraint
      fields:
        - article
      name: article_campaign_article_uniq
  index: []
